% !Mode:: "TeX:UTF-8"

\chapter{引言}

The theory and application of electromagnetic wave has been developed greatly in last about one hundred years since the Maxwell equations were established. The researches and applications in the area of electromagnetic wave have dived into every sub-area, like radar technologies, microwave, antenna, the propagation of wireless, modeling of waveguide, electromagnetic imaging, and electromagnetic probe. In real environment, the process of propagation of electromagnetic wave is very complicated, like the scattering of an complex object, the real communication in city at a complicated topography, and the propagation in waveguide. So, it is very useful if we can know the specific feature of electromagnetic wave under some real environments like we mentioned before and we already have two important ways to do it, which are simulating and theoretical analyzing. The theoretical analyzing method, however, can only answer some typical problems, not too complex problems derived from real environments and involving real electromagnetic arguments. Unfortunately, we always have to deal with the later one, which means that we have to use the simulating way to solve those problems which derived from real circumstances and motivated the development of computational electromagnectics. 
自从1873年 Maxwell方程建立以来，电磁波理论和应用在一百多年来取得了巨大的发展。电磁波的研究与应用已经深入到各个领域，例如雷达技术、微波、天线、无线电传播、博导建模、电磁成像、地下电磁探测，等等。在实际环境中，电磁波的传播过程非常复杂，例如复杂目标的散射，复杂的城市地形中的实际通信，波导和微带结构中的传播。为了具体的研究这些环境中电磁波的特性十分有用，实验和理论分析计算是两个重要的手段，通常只有一些经典问题有解析解，在结合实际环境的电磁参数进行计算时往往会遇到环境太过复杂无法得到解析解的情形，因此需要通过数值解得到具体环境下的电磁波特性，计算电磁学因此而发展起来。随着计算机技术的发展，目前已经提出求解麦克斯韦方程的许多重要的数值解方法，例如矩量法（MoM）、有限元法（FEM）、边界元法（BEM）以及时域有限差分法（FDTD）等。

1966年 K. S. Yee \cite{Yee} 首次提出了 FDTD 方法，该方法在空间和时间上对麦克斯韦方程使用中心差分进行了离散，然后对得到的离散方程在软件或者硬件上使用“蛙跳”方式进行求解：电场分量在空间中就给定的某一时刻求解，然后磁场分量在同样的空间区域在紧接着的下一时刻进行求解，然后不断重复这一过程，直到电磁场演化到欲求的结果或者稳定。这一方法自提出后得到了迅速发展和广泛应用，在许多科学和实际问题，例如辐射天线的分析、微波器件和电磁兼容分析的解决中起到重要作用。

FDTD 的发展和应用面临两个主要问题，第一是边界条件问题。因为计算机容量的限制，FDTD 计算只能在有限区域进行，不可能计算开区域的电磁场。如果要模拟开域电磁过程，在计算区域的阶段边界处必须给出吸收边界条件。针对这个问题， Taylor 等 \cite{taylor} 于1969年提出简单插值边界， Mur \cite{mur1981absorbing} 于1981年提出了一种十分有效的 Mur 吸收边界条件后来被广泛采用， Berenger \cite{berenger1994perfectly} 于1994年提出了一种全新的吸收边界，即完全匹配层（Perfectly Matched Layer，PML），在此基础上 Sacks \cite{sacks} 等和 Gedney \cite{gedney} 等提出了各向异性介质的 PML， Chew 以及 Weedon \cite{chew} 提出坐标伸缩的 PML。这几种 PML 已经作为吸收边界得到了广泛的应用。

由于 FDTD 方法在使用时需要对整个计算区域进行格划分，并且由于 Courant 稳定性条件空间的格划分需要足够精细来求解最小的电磁波波长部分，所以在求解较为大型的仿真区域时会产生很大的计算区域。时间步长和空间步长一样需要满足 Courant 稳定性条件，所以电磁场演进的时间步数目有最小值限制。这两点导致使用 FDTD 求解时需要很长的求解时间。因此 FDTD 方法面临的第二个问题就是缩短计算时间。 FDTD 具有天然的并行特点，即在计算时，两个相邻的子计算域只需要交换域交界面上的切向场值数据。利用这个特点，发展起了许多区域分割并行 FDTD 算法. 在这些并行算法中，原始待求解问题空间被分割为一些子空间，然后把每一个子空间分配给一个计算核心，在每一步的计算后都交换相邻子空间交界面上的数据。

区域分割并行算法是属于任务并行层次的并行算法。任务并行是一种较高层次的并行，更低一层的指令并行由 CPU 自发完成不需要人为参与，而最低层次的数据并行，则存在着待挖掘的计算性能。起初人们直接使用 CPU 计算时，使用的是 CPU 的算数逻辑单元（arithmetic logic unit， ALU），一次只能对单个数据完成一次运算。为了实现数据并行，挖掘 CPU 的计算潜力，我们需要使用 VALU 进行计算。 VALU 是一个中央处理单元，和 ALU 的不同之处在于在其中我们可以使用指令来对称作向量的一个数列进行操作，而不仅仅是单个数据，因此 VALU 能极大的提高计算性能，尤其是在数值仿真任务中。目前，在几乎绝大数商业 CPU ，例如 Intel 和 AMD ，都提供操作向量的指令集，例如 VIS ， MX ， SSE 和 AVX 。因此 VALU 的一大优势就是使用便捷。在过去的研究中， L. Zhang 和 W. Yu \cite{LZhangandWYu} 使用 SSE 操作 VALU 对 3D FDTD 的单精度计算进行了加速。 M. Livesey、 F. Costen 和 X. Yang \cite{Doubleprecision} 将工作拓展到双精度计算中。 Y. L \cite{AdvancedFDTDMethod} 等给出了使用VALU计算的伪代码。然而之前的这些研究忽略了在不同边界条件的特征的差别。本文针对某些特定的边界条件，例如吸收边界条件（MUR），给出使用 VALU 计算 FDTD 时的新的计算模型，进一步挖掘计算效率的潜力。在文中，我们给出了 2D FDTD 的 C++ 实现作为示例，并通过 Visual Studio 对计算性能进行比较和分析。改计算模型可拓展到 3D FDTD 情形中。

虽然的 CPU 的各个并行层次都有了针对仿真计算的并行加速方案，但是 CPU 的设计目的是以更高的操作频率、更多的寄存器以及更复杂的 ALU 来作为计算机的核心来完成可能遇到的各种通用操作，而非专门完成数据的数学计算。因此使用 CPU 进行 FDTD 运算虽然是可行的，但是既不能充分发挥 CPU 的特点，也不能满足 FDTD 运算的效率需求。所以具有几百个计算核心、适合进行大量数据、重复计算的图形处理器（Graphic Processor Unit，GPU）开始被运用于 FDTD 计算。 GPU 的概念于1999年被提出，2004年，Sean E. Krakiwsky 等\cite{Krakiwsky}首次尝试用 GPU 加速 FDTD 算法。由于起初 GPU 并不是被设计用于普遍计算的，因此使用 GPU 计算并不便捷，需要学习 GPU 的内部结构以及专门的硬件语言。这种情况在2006年产生了具有通用计算架构的 GPU 之后得到了改变。2007年， CUDA 正式发布。 CUDA 的出现允许人们方便的使用已经熟悉的 Fortran 、 C 等进行 GPU 计算编程，大大的加快了利用 CUDA 对 FDTD 进行加速的研究。 J. A. Roden 和 S. Gedney\cite{Roden} 提出了 CPML 边界条件下使用 CUDA 加速的方案，但没有提供实现细节。 Veysel Demir \cite{Demir}提出了周期边界条件条件下使用 CUDA 加速的 FDTD 方案。本文使用 CUDA 对二维 FDTD 的截断边界条件、 Mur 吸收边界条件以及 CPML 吸收边界条件进行加速。

